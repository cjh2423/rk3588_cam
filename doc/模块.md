# 开发进度与模块规划

## 当前状态 (Current Status)

### 已完成 (Done)
1.  **基础架构搭建**:
    - CMake 交叉编译环境 (`build.sh`, `CMakeLists.txt`).
    - Qt5 UI 框架 (`CameraView`, `AppController`).
    - 多线程模型框架 (`PreprocessingThread` 分离).
2.  **硬件层 (Hardware)**:
    - V4L2 摄像头采集 (`CameraDevice`).
    - **RGA 硬件加速**: 集成 `librga` 实现高效 Resize 和 Flip.
3.  **核心算法移植 (Core)**:
    - `YOLOv8-face` 代码移植完成 (`src/core/yolov8_face.cc`).
    - `FaceNet` 代码移植完成 (`src/core/facenet.cc`).
    - 模型管理器 `ModelManager` 初步实现 (`src/core/model_manager.cc`).
4.  **性能监控**:
    - `PerformanceMonitor` 实现 FPS 统计.

### 进行中/待办 (To-Do)

1.  **NPU 推理集成 (Integration)**:
    - [ ] 在 `AppController` 或新建 `NpuThread` 中调用 `ModelManager` 执行推理.
    - [ ] 实现 NPU 结果的后处理 (画框、人脸对齐).
    - [ ] 将结果叠加显示到 UI.

2.  **数据库模块 (Database)**:
    - [ ] 移植 SQLite3 数据库管理代码.
    - [ ] 实现 `UserDao`, `FaceFeatureDao`.
    - [ ] 集成到应用逻辑中 (注册/识别记录).

3.  **特征库管理 (Feature Library)**:
    - [ ] 实现内存中的人脸特征向量搜索 (1:N 搜索).
    - [ ] 优化搜索性能 (如使用 SIMD 或简单的线性搜索).

4.  **业务逻辑完善**:
    - [ ] 人脸注册流程 (UI 交互).
    - [ ] 考勤打卡逻辑.

## 开发顺序回顾

1.  ~~纯摄像头显示到GUI层~~ (已完成)
2.  ~~app_controller分出预处理线程和显示线程~~ (已完成，集成RGA)
3.  ~~直接移植开源的core目录代码~~ (已完成，待集成调用)
4.  **移植database目录代码** (下一步重点)
    - `include/database/*.h`
    - `src/database/*.cc`
5.  **移植人脸特征库管理器**
    - `feature_library`
6.  ~~重新移植性能监控器~~ (已完成)
7.  **移植后处理器**
    - 结合 NPU 输出进行最终的 Draw 操作.