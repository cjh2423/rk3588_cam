# 模块功能说明与进度

## 1. 已实现模块

### 1.1 App 层 (业务逻辑)
- **AppController**: 核心调度器，管理线程生命周期与业务流程（如注册逻辑）。
- **PreprocessingThread**: 集成 RGA 硬件加速，支持 Letterbox 预处理。
- **InferenceThread**: 异步推理引擎，**专注于 YOLOv8 NPU 检测**。
- **PostProcessThread**: 后处理引擎，负责 NMS、FaceNet 识别与数据库交互。
- **PerformanceMonitor**: FPS 统计与性能监控 (Cam/NPU/Post)。

### 1.2 GUI 层 (交互界面)
- **CameraView**: 主界面，显示实时画面与识别结果。
- **UserManagerWidget**: 用户管理对话框，支持查看与删除用户。
- **RegistrationDialog**: 人脸注册对话框，支持多帧采集与引导式录入。

### 1.3 Core 层 (算法/库适配)
- **ModelManager**: 统一管理 YOLOv8 和 FaceNet 模型的加载。
- **YOLOv8-face**: 适配 RK3588 NPU 的人脸检测实现。
- **FaceNet**: 特征提取模型适配。
- **Postprocess**: 结果解析与坐标还原算法。

### 1.4 Service / Database 层
- **AttendanceService**: 考勤业务逻辑封装。
- **FeatureLibrary**: 内存特征库，支持 1:N 高速搜索。
- **DatabaseManager**: SQLite 连接管理。
- **DAO**: User/FaceFeature/Attendance 数据访问对象。

### 1.5 Hardware 层
- **CameraDevice**: 基于 V4L2 的异步视频流采集。

## 2. 待开发模块 (Next Steps)
- [ ] **人脸对齐**: 在 `InferenceThread` 中根据关键点进行仿射变换 (目前为简单裁剪)。
- [ ] **活体检测**: 增加防伪功能。

## 3. 关键配置
- **PROJECT_MODE**: 当前设为 `1` (AI 模式)。
- **CAMERA_ID**: 设为 `21` (适配开发板)。
- **Paths**: 模型存放于 `model/` 目录，数据库为运行目录下的 `data.db`。
